{
  "timestamp": "20251022_003732",
  "summary": {
    "total": 12,
    "passed": 2,
    "failed": 0,
    "errors": 10,
    "pass_rate": 16.666666666666664,
    "avg_tokens": 695.5,
    "total_tokens": 1391
  },
  "results": [
    {
      "scenario_id": "S1_debut_conversation",
      "description": "Client démarre la conversation - rien collecté",
      "status": "ERROR",
      "error": "JSON parse error: Expecting value: line 1 column 1 (char 0)",
      "raw_response": "Analyse de l'état actuel :\n\n- Produit et variante sont manquants.\n- Zone et téléphone sont également manquants.\n\nEn fonction de la logique de décision, si le produit et la variante sont manquants, alors la phase suivante est :\n\n{\"phase\": 1, \"raison\": \"Produit et variante manquants\"}",
      "prompt": "Tu es un routeur de workflow commercial. Analyse l'état de la collecte de données et détermine la phase suivante.\n\n## DONNÉES À COLLECTER (dans l'ordre)\n\n1. **PRODUIT + VARIANTE** (obligatoires ensemble)\n2. **ZONE + CONTACT** (obligatoires ensemble)  \n3. **PAIEMENT** (validation finale)\n\n## ÉTAT ACTUEL\n\n📦 Produit: ❌ manquant\n🔧 Variante: ❌ manquant\n📍 Zone: ❌ manquant\n📞 Téléphone: ❌ manquant\n💳 Paiement: ❌ manquant\n\n## HISTORIQUE CONVERSATION\n\nClient: Bonjour\n\n## DONNÉES COLLECTÉES\n\n- produit: ❌ manquant\n- variante: ❌ manquant\n- zone: ❌ manquant\n- telephone: ❌ manquant\n- paiement: ❌ manquant\n\n## LOGIQUE DE DÉCISION (STRICTE)\n\n**PHASE 1 - Collecte Produit/Variante**\n→ SI produit = ❌ manquant OU variante = ❌ manquant\n→ ALORS Phase 1\n\n**PHASE 2 - Collecte Livraison/Contact**\n→ SI produit ≠ ❌ manquant ET variante ≠ ❌ manquant\n→ ET (zone = ❌ manquant OU telephone = ❌ manquant)\n→ ALORS Phase 2\n\n**PHASE 3 - Validation Paiement**\n→ SI produit ≠ ❌ manquant ET variante ≠ ❌ manquant\n→ ET zone ≠ ❌ manquant ET telephone ≠ ❌ manquant\n→ ALORS Phase 3\n\n## EXEMPLES\n\n**Exemple 1:**\n- Produit: ❌ manquant, Variante: ❌ manquant\n- Décision: Phase 1 (produit et variante manquants)\n\n**Exemple 2:**\n- Produit: \"Chaussures Nike\", Variante: \"Taille 42\"\n- Zone: ❌ manquant, Téléphone: ❌ manquant\n- Décision: Phase 2 (produit/variante OK, collecte livraison)\n\n**Exemple 3:**\n- Produit: \"Chaussures Nike\", Variante: \"Taille 42\"\n- Zone: \"Paris\", Téléphone: \"0601020304\"\n- Paiement: \"pending\"\n- Décision: Phase 3 (tout collecté, attente paiement)\n\n---\n\nQuestion client: Bonjour\n\nAnalyse l'ÉTAT ACTUEL ci-dessus et retourne UNIQUEMENT:\n{\"phase\": X, \"raison\": \"explication courte\"}\n"
    },
    {
      "scenario_id": "S2_produit_sans_variante",
      "description": "Client mentionne produit mais pas la variante",
      "status": "ERROR",
      "error": "JSON parse error: Expecting value: line 1 column 1 (char 0)",
      "raw_response": "Analyse de l'état actuel :\n\n- Produit : \"Couches à pression\" (collecté)\n- Variante : ❌ manquant (manquant)\n- Zone : ❌ manquant (manquant)\n- Téléphone : ❌ manquant (manquant)\n- Paiement : ❌ manquant (manquant)\n\nEn fonction de la logique de décision, la phase suivante est déterminée comme suit :\n\n- Produit et variante sont collectés, mais zone, téléphone et paiement sont manquants.\n- La condition de Phase 2 est remplie car produit et variante ne sont pas manquants, et zone et téléphone sont manquants.\n\nLa phase suivante",
      "prompt": "Tu es un routeur de workflow commercial. Analyse l'état de la collecte de données et détermine la phase suivante.\n\n## DONNÉES À COLLECTER (dans l'ordre)\n\n1. **PRODUIT + VARIANTE** (obligatoires ensemble)\n2. **ZONE + CONTACT** (obligatoires ensemble)  \n3. **PAIEMENT** (validation finale)\n\n## ÉTAT ACTUEL\n\n📦 Produit: Couches à pression\n🔧 Variante: ❌ manquant\n📍 Zone: ❌ manquant\n📞 Téléphone: ❌ manquant\n💳 Paiement: ❌ manquant\n\n## HISTORIQUE CONVERSATION\n\nClient: Je veux des couches à pression\nAgent: Quelle taille vous intéresse?\n\n## DONNÉES COLLECTÉES\n\n- produit: Couches à pression\n- variante: ❌ manquant\n- zone: ❌ manquant\n- telephone: ❌ manquant\n- paiement: ❌ manquant\n\n## LOGIQUE DE DÉCISION (STRICTE)\n\n**PHASE 1 - Collecte Produit/Variante**\n→ SI produit = ❌ manquant OU variante = ❌ manquant\n→ ALORS Phase 1\n\n**PHASE 2 - Collecte Livraison/Contact**\n→ SI produit ≠ ❌ manquant ET variante ≠ ❌ manquant\n→ ET (zone = ❌ manquant OU telephone = ❌ manquant)\n→ ALORS Phase 2\n\n**PHASE 3 - Validation Paiement**\n→ SI produit ≠ ❌ manquant ET variante ≠ ❌ manquant\n→ ET zone ≠ ❌ manquant ET telephone ≠ ❌ manquant\n→ ALORS Phase 3\n\n## EXEMPLES\n\n**Exemple 1:**\n- Produit: ❌ manquant, Variante: ❌ manquant\n- Décision: Phase 1 (produit et variante manquants)\n\n**Exemple 2:**\n- Produit: \"Chaussures Nike\", Variante: \"Taille 42\"\n- Zone: ❌ manquant, Téléphone: ❌ manquant\n- Décision: Phase 2 (produit/variante OK, collecte livraison)\n\n**Exemple 3:**\n- Produit: \"Chaussures Nike\", Variante: \"Taille 42\"\n- Zone: \"Paris\", Téléphone: \"0601020304\"\n- Paiement: \"pending\"\n- Décision: Phase 3 (tout collecté, attente paiement)\n\n---\n\nQuestion client: Je veux des couches à pression\n\nAnalyse l'ÉTAT ACTUEL ci-dessus et retourne UNIQUEMENT:\n{\"phase\": X, \"raison\": \"explication courte\"}\n"
    },
    {
      "scenario_id": "S3_variante_sans_produit",
      "description": "Client mentionne taille mais produit pas clair",
      "status": "ERROR",
      "error": "JSON parse error: Expecting value: line 1 column 1 (char 0)",
      "raw_response": "Analyse de l'état actuel :\n\n- Produit: ❌ manquant\n- Variante: Taille 3 (collectée)\n- Zone: ❌ manquant\n- Téléphone: ❌ manquant\n- Paiement: ❌ manquant\n\nEn fonction de la logique de décision, la phase suivante est déterminée comme suit :\n\n- La phase 1 est déclenchée si le produit ou la variante est manquant. Dans ce cas, le produit est manquant, donc la phase 1 est déclenchée.\n\nRésultat :\n{\"phase\": 1, \"raison\": \"produit manquant\"}",
      "prompt": "Tu es un routeur de workflow commercial. Analyse l'état de la collecte de données et détermine la phase suivante.\n\n## DONNÉES À COLLECTER (dans l'ordre)\n\n1. **PRODUIT + VARIANTE** (obligatoires ensemble)\n2. **ZONE + CONTACT** (obligatoires ensemble)  \n3. **PAIEMENT** (validation finale)\n\n## ÉTAT ACTUEL\n\n📦 Produit: ❌ manquant\n🔧 Variante: Taille 3\n📍 Zone: ❌ manquant\n📞 Téléphone: ❌ manquant\n💳 Paiement: ❌ manquant\n\n## HISTORIQUE CONVERSATION\n\nClient: Taille 3\nAgent: Taille 3 de quel produit?\n\n## DONNÉES COLLECTÉES\n\n- produit: ❌ manquant\n- variante: Taille 3\n- zone: ❌ manquant\n- telephone: ❌ manquant\n- paiement: ❌ manquant\n\n## LOGIQUE DE DÉCISION (STRICTE)\n\n**PHASE 1 - Collecte Produit/Variante**\n→ SI produit = ❌ manquant OU variante = ❌ manquant\n→ ALORS Phase 1\n\n**PHASE 2 - Collecte Livraison/Contact**\n→ SI produit ≠ ❌ manquant ET variante ≠ ❌ manquant\n→ ET (zone = ❌ manquant OU telephone = ❌ manquant)\n→ ALORS Phase 2\n\n**PHASE 3 - Validation Paiement**\n→ SI produit ≠ ❌ manquant ET variante ≠ ❌ manquant\n→ ET zone ≠ ❌ manquant ET telephone ≠ ❌ manquant\n→ ALORS Phase 3\n\n## EXEMPLES\n\n**Exemple 1:**\n- Produit: ❌ manquant, Variante: ❌ manquant\n- Décision: Phase 1 (produit et variante manquants)\n\n**Exemple 2:**\n- Produit: \"Chaussures Nike\", Variante: \"Taille 42\"\n- Zone: ❌ manquant, Téléphone: ❌ manquant\n- Décision: Phase 2 (produit/variante OK, collecte livraison)\n\n**Exemple 3:**\n- Produit: \"Chaussures Nike\", Variante: \"Taille 42\"\n- Zone: \"Paris\", Téléphone: \"0601020304\"\n- Paiement: \"pending\"\n- Décision: Phase 3 (tout collecté, attente paiement)\n\n---\n\nQuestion client: Taille 3\n\nAnalyse l'ÉTAT ACTUEL ci-dessus et retourne UNIQUEMENT:\n{\"phase\": X, \"raison\": \"explication courte\"}\n"
    },
    {
      "scenario_id": "S4_produit_variante_ok",
      "description": "Produit + variante collectés, passage à livraison",
      "status": "ERROR",
      "error": "JSON parse error: Expecting value: line 1 column 1 (char 0)",
      "raw_response": "Analyse de l'état actuel :\n\n- Produit : \"Couches à pression\" (collecté)\n- Variante : \"Taille 3 - Lot 300\" (collecté)\n- Zone : ❌ manquant\n- Téléphone : ❌ manquant\n- Paiement : ❌ manquant\n\nEn fonction de la logique de décision, on voit que :\n- Produit et variante sont collectés, donc la condition de Phase 1 n'est pas remplie.\n- Zone et téléphone sont manquants, donc la condition de Phase 2 est remplie.\n\nLa décision est donc :\n\n{\"phase\": 2, \"raison\": \"Zone et téléphone manquants\"}",
      "prompt": "Tu es un routeur de workflow commercial. Analyse l'état de la collecte de données et détermine la phase suivante.\n\n## DONNÉES À COLLECTER (dans l'ordre)\n\n1. **PRODUIT + VARIANTE** (obligatoires ensemble)\n2. **ZONE + CONTACT** (obligatoires ensemble)  \n3. **PAIEMENT** (validation finale)\n\n## ÉTAT ACTUEL\n\n📦 Produit: Couches à pression\n🔧 Variante: Taille 3 - Lot 300\n📍 Zone: ❌ manquant\n📞 Téléphone: ❌ manquant\n💳 Paiement: ❌ manquant\n\n## HISTORIQUE CONVERSATION\n\nClient: Je veux des couches à pression\nAgent: Quelle taille?\nClient: Taille 3, lot de 300\nAgent: Parfait! Dans quelle zone livrer?\n\n## DONNÉES COLLECTÉES\n\n- produit: Couches à pression\n- variante: Taille 3 - Lot 300\n- zone: ❌ manquant\n- telephone: ❌ manquant\n- paiement: ❌ manquant\n\n## LOGIQUE DE DÉCISION (STRICTE)\n\n**PHASE 1 - Collecte Produit/Variante**\n→ SI produit = ❌ manquant OU variante = ❌ manquant\n→ ALORS Phase 1\n\n**PHASE 2 - Collecte Livraison/Contact**\n→ SI produit ≠ ❌ manquant ET variante ≠ ❌ manquant\n→ ET (zone = ❌ manquant OU telephone = ❌ manquant)\n→ ALORS Phase 2\n\n**PHASE 3 - Validation Paiement**\n→ SI produit ≠ ❌ manquant ET variante ≠ ❌ manquant\n→ ET zone ≠ ❌ manquant ET telephone ≠ ❌ manquant\n→ ALORS Phase 3\n\n## EXEMPLES\n\n**Exemple 1:**\n- Produit: ❌ manquant, Variante: ❌ manquant\n- Décision: Phase 1 (produit et variante manquants)\n\n**Exemple 2:**\n- Produit: \"Chaussures Nike\", Variante: \"Taille 42\"\n- Zone: ❌ manquant, Téléphone: ❌ manquant\n- Décision: Phase 2 (produit/variante OK, collecte livraison)\n\n**Exemple 3:**\n- Produit: \"Chaussures Nike\", Variante: \"Taille 42\"\n- Zone: \"Paris\", Téléphone: \"0601020304\"\n- Paiement: \"pending\"\n- Décision: Phase 3 (tout collecté, attente paiement)\n\n---\n\nQuestion client: Taille 3, lot de 300\n\nAnalyse l'ÉTAT ACTUEL ci-dessus et retourne UNIQUEMENT:\n{\"phase\": X, \"raison\": \"explication courte\"}\n"
    },
    {
      "scenario_id": "S5_zone_sans_contact",
      "description": "Zone collectée mais pas le téléphone",
      "status": "ERROR",
      "error": "JSON parse error: Expecting value: line 1 column 1 (char 0)",
      "raw_response": "Analyse de l'état actuel :\n\n- Produit et variante sont collectés : \"Couches à pression\" et \"Taille 3 - Lot 300\"\n- Zone est collectée : \"Angré\"\n- Téléphone est manquant\n- Paiement est manquant\n\nEn fonction de la logique de décision, nous sommes dans la situation suivante :\n\n- Produit et variante ne sont pas manquants, donc nous ne sommes pas dans la Phase 1.\n- Zone est collectée, mais téléphone est manquant, donc nous sommes dans la situation où zone n'est pas manquante mais téléphone est manquant.\n- Nous sommes donc dans la Phase 2.\n\nLa décision est",
      "prompt": "Tu es un routeur de workflow commercial. Analyse l'état de la collecte de données et détermine la phase suivante.\n\n## DONNÉES À COLLECTER (dans l'ordre)\n\n1. **PRODUIT + VARIANTE** (obligatoires ensemble)\n2. **ZONE + CONTACT** (obligatoires ensemble)  \n3. **PAIEMENT** (validation finale)\n\n## ÉTAT ACTUEL\n\n📦 Produit: Couches à pression\n🔧 Variante: Taille 3 - Lot 300\n📍 Zone: Angré\n📞 Téléphone: ❌ manquant\n💳 Paiement: ❌ manquant\n\n## HISTORIQUE CONVERSATION\n\nClient: Je suis à Angré\nAgent: Quel est votre numéro de téléphone?\n\n## DONNÉES COLLECTÉES\n\n- produit: Couches à pression\n- variante: Taille 3 - Lot 300\n- zone: Angré\n- telephone: ❌ manquant\n- paiement: ❌ manquant\n\n## LOGIQUE DE DÉCISION (STRICTE)\n\n**PHASE 1 - Collecte Produit/Variante**\n→ SI produit = ❌ manquant OU variante = ❌ manquant\n→ ALORS Phase 1\n\n**PHASE 2 - Collecte Livraison/Contact**\n→ SI produit ≠ ❌ manquant ET variante ≠ ❌ manquant\n→ ET (zone = ❌ manquant OU telephone = ❌ manquant)\n→ ALORS Phase 2\n\n**PHASE 3 - Validation Paiement**\n→ SI produit ≠ ❌ manquant ET variante ≠ ❌ manquant\n→ ET zone ≠ ❌ manquant ET telephone ≠ ❌ manquant\n→ ALORS Phase 3\n\n## EXEMPLES\n\n**Exemple 1:**\n- Produit: ❌ manquant, Variante: ❌ manquant\n- Décision: Phase 1 (produit et variante manquants)\n\n**Exemple 2:**\n- Produit: \"Chaussures Nike\", Variante: \"Taille 42\"\n- Zone: ❌ manquant, Téléphone: ❌ manquant\n- Décision: Phase 2 (produit/variante OK, collecte livraison)\n\n**Exemple 3:**\n- Produit: \"Chaussures Nike\", Variante: \"Taille 42\"\n- Zone: \"Paris\", Téléphone: \"0601020304\"\n- Paiement: \"pending\"\n- Décision: Phase 3 (tout collecté, attente paiement)\n\n---\n\nQuestion client: Je suis à Angré\n\nAnalyse l'ÉTAT ACTUEL ci-dessus et retourne UNIQUEMENT:\n{\"phase\": X, \"raison\": \"explication courte\"}\n"
    },
    {
      "scenario_id": "S6_contact_sans_zone",
      "description": "Téléphone collecté mais pas la zone",
      "status": "ERROR",
      "error": "JSON parse error: Expecting value: line 1 column 1 (char 0)",
      "raw_response": "Analyse de l'état actuel :\n\n- Produit et variante sont collectés.\n- Zone est manquante.\n- Téléphone est collecté.\n- Paiement est manquant.\n\nEn fonction de la logique de décision, on se situe dans la phase 2 car le produit et la variante ne sont pas manquants, mais la zone est manquante.\n\nLa décision est donc :\n\n{\"phase\": 2, \"raison\": \"Zone manquante\"}",
      "prompt": "Tu es un routeur de workflow commercial. Analyse l'état de la collecte de données et détermine la phase suivante.\n\n## DONNÉES À COLLECTER (dans l'ordre)\n\n1. **PRODUIT + VARIANTE** (obligatoires ensemble)\n2. **ZONE + CONTACT** (obligatoires ensemble)  \n3. **PAIEMENT** (validation finale)\n\n## ÉTAT ACTUEL\n\n📦 Produit: Couches à pression\n🔧 Variante: Taille 3 - Lot 300\n📍 Zone: ❌ manquant\n📞 Téléphone: 0707070707\n💳 Paiement: ❌ manquant\n\n## HISTORIQUE CONVERSATION\n\nClient: Mon numéro c'est 0707070707\nAgent: Dans quelle zone êtes-vous?\n\n## DONNÉES COLLECTÉES\n\n- produit: Couches à pression\n- variante: Taille 3 - Lot 300\n- zone: ❌ manquant\n- telephone: 0707070707\n- paiement: ❌ manquant\n\n## LOGIQUE DE DÉCISION (STRICTE)\n\n**PHASE 1 - Collecte Produit/Variante**\n→ SI produit = ❌ manquant OU variante = ❌ manquant\n→ ALORS Phase 1\n\n**PHASE 2 - Collecte Livraison/Contact**\n→ SI produit ≠ ❌ manquant ET variante ≠ ❌ manquant\n→ ET (zone = ❌ manquant OU telephone = ❌ manquant)\n→ ALORS Phase 2\n\n**PHASE 3 - Validation Paiement**\n→ SI produit ≠ ❌ manquant ET variante ≠ ❌ manquant\n→ ET zone ≠ ❌ manquant ET telephone ≠ ❌ manquant\n→ ALORS Phase 3\n\n## EXEMPLES\n\n**Exemple 1:**\n- Produit: ❌ manquant, Variante: ❌ manquant\n- Décision: Phase 1 (produit et variante manquants)\n\n**Exemple 2:**\n- Produit: \"Chaussures Nike\", Variante: \"Taille 42\"\n- Zone: ❌ manquant, Téléphone: ❌ manquant\n- Décision: Phase 2 (produit/variante OK, collecte livraison)\n\n**Exemple 3:**\n- Produit: \"Chaussures Nike\", Variante: \"Taille 42\"\n- Zone: \"Paris\", Téléphone: \"0601020304\"\n- Paiement: \"pending\"\n- Décision: Phase 3 (tout collecté, attente paiement)\n\n---\n\nQuestion client: Mon numéro c'est 0707070707\n\nAnalyse l'ÉTAT ACTUEL ci-dessus et retourne UNIQUEMENT:\n{\"phase\": X, \"raison\": \"explication courte\"}\n"
    },
    {
      "scenario_id": "S7_tout_sauf_paiement",
      "description": "Tout collecté sauf paiement - attente validation",
      "status": "ERROR",
      "error": "JSON parse error: Expecting value: line 1 column 1 (char 0)",
      "raw_response": "Analyse de l'état actuel :\n\n- Produit et variante sont collectés et validés.\n- Zone et téléphone sont collectés et validés.\n- Paiement est en attente de validation.\n\nEn fonction de la logique de décision, nous sommes dans la phase 3 car tous les éléments obligatoires sont collectés et validés, excepté le paiement qui est en attente de validation.\n\nLa décision est donc :\n\n{\"phase\": 3, \"raison\": \"Tous les éléments obligatoires sont collectés et validés, excepté le paiement en attente de validation.\"}",
      "prompt": "Tu es un routeur de workflow commercial. Analyse l'état de la collecte de données et détermine la phase suivante.\n\n## DONNÉES À COLLECTER (dans l'ordre)\n\n1. **PRODUIT + VARIANTE** (obligatoires ensemble)\n2. **ZONE + CONTACT** (obligatoires ensemble)  \n3. **PAIEMENT** (validation finale)\n\n## ÉTAT ACTUEL\n\n📦 Produit: Couches à pression\n🔧 Variante: Taille 3 - Lot 300\n📍 Zone: Angré\n📞 Téléphone: 0707070707\n💳 Paiement: pending\n\n## HISTORIQUE CONVERSATION\n\nClient: Mon numéro c'est 0707070707\nAgent: Parfait! Envoyez votre capture de paiement\nClient: Je l'ai envoyée\n\n## DONNÉES COLLECTÉES\n\n- produit: Couches à pression\n- variante: Taille 3 - Lot 300\n- zone: Angré\n- telephone: 0707070707\n- paiement: pending\n\n## LOGIQUE DE DÉCISION (STRICTE)\n\n**PHASE 1 - Collecte Produit/Variante**\n→ SI produit = ❌ manquant OU variante = ❌ manquant\n→ ALORS Phase 1\n\n**PHASE 2 - Collecte Livraison/Contact**\n→ SI produit ≠ ❌ manquant ET variante ≠ ❌ manquant\n→ ET (zone = ❌ manquant OU telephone = ❌ manquant)\n→ ALORS Phase 2\n\n**PHASE 3 - Validation Paiement**\n→ SI produit ≠ ❌ manquant ET variante ≠ ❌ manquant\n→ ET zone ≠ ❌ manquant ET telephone ≠ ❌ manquant\n→ ALORS Phase 3\n\n## EXEMPLES\n\n**Exemple 1:**\n- Produit: ❌ manquant, Variante: ❌ manquant\n- Décision: Phase 1 (produit et variante manquants)\n\n**Exemple 2:**\n- Produit: \"Chaussures Nike\", Variante: \"Taille 42\"\n- Zone: ❌ manquant, Téléphone: ❌ manquant\n- Décision: Phase 2 (produit/variante OK, collecte livraison)\n\n**Exemple 3:**\n- Produit: \"Chaussures Nike\", Variante: \"Taille 42\"\n- Zone: \"Paris\", Téléphone: \"0601020304\"\n- Paiement: \"pending\"\n- Décision: Phase 3 (tout collecté, attente paiement)\n\n---\n\nQuestion client: Je l'ai envoyée\n\nAnalyse l'ÉTAT ACTUEL ci-dessus et retourne UNIQUEMENT:\n{\"phase\": X, \"raison\": \"explication courte\"}\n"
    },
    {
      "scenario_id": "S8_paiement_valide",
      "description": "Paiement validé - commande complète",
      "status": "ERROR",
      "error": "JSON parse error: Expecting value: line 1 column 1 (char 0)",
      "raw_response": "Analyse de l'état actuel :\n\n- Produit et variante sont collectés et valides.\n- Zone et téléphone sont collectés et valides.\n- Paiement est déjà validé.\n\nEn fonction de la logique de décision, puisque les conditions de Phase 1 et Phase 2 sont remplies, mais que la condition de Phase 3 est également remplie (produit et variante valides, zone et téléphone valides, et paiement déjà validé), la décision est ambiguë.\n\nCependant, puisque la question client \"Merci, quand je reçois?\" suggère que la commande est confirmée et que l'attente est la livraison, il est probable que",
      "prompt": "Tu es un routeur de workflow commercial. Analyse l'état de la collecte de données et détermine la phase suivante.\n\n## DONNÉES À COLLECTER (dans l'ordre)\n\n1. **PRODUIT + VARIANTE** (obligatoires ensemble)\n2. **ZONE + CONTACT** (obligatoires ensemble)  \n3. **PAIEMENT** (validation finale)\n\n## ÉTAT ACTUEL\n\n📦 Produit: Couches à pression\n🔧 Variante: Taille 3 - Lot 300\n📍 Zone: Angré\n📞 Téléphone: 0707070707\n💳 Paiement: paid\n\n## HISTORIQUE CONVERSATION\n\nAgent: Paiement validé! Commande confirmée\nClient: Merci, quand je reçois?\n\n## DONNÉES COLLECTÉES\n\n- produit: Couches à pression\n- variante: Taille 3 - Lot 300\n- zone: Angré\n- telephone: 0707070707\n- paiement: paid\n\n## LOGIQUE DE DÉCISION (STRICTE)\n\n**PHASE 1 - Collecte Produit/Variante**\n→ SI produit = ❌ manquant OU variante = ❌ manquant\n→ ALORS Phase 1\n\n**PHASE 2 - Collecte Livraison/Contact**\n→ SI produit ≠ ❌ manquant ET variante ≠ ❌ manquant\n→ ET (zone = ❌ manquant OU telephone = ❌ manquant)\n→ ALORS Phase 2\n\n**PHASE 3 - Validation Paiement**\n→ SI produit ≠ ❌ manquant ET variante ≠ ❌ manquant\n→ ET zone ≠ ❌ manquant ET telephone ≠ ❌ manquant\n→ ALORS Phase 3\n\n## EXEMPLES\n\n**Exemple 1:**\n- Produit: ❌ manquant, Variante: ❌ manquant\n- Décision: Phase 1 (produit et variante manquants)\n\n**Exemple 2:**\n- Produit: \"Chaussures Nike\", Variante: \"Taille 42\"\n- Zone: ❌ manquant, Téléphone: ❌ manquant\n- Décision: Phase 2 (produit/variante OK, collecte livraison)\n\n**Exemple 3:**\n- Produit: \"Chaussures Nike\", Variante: \"Taille 42\"\n- Zone: \"Paris\", Téléphone: \"0601020304\"\n- Paiement: \"pending\"\n- Décision: Phase 3 (tout collecté, attente paiement)\n\n---\n\nQuestion client: Merci, quand je reçois?\n\nAnalyse l'ÉTAT ACTUEL ci-dessus et retourne UNIQUEMENT:\n{\"phase\": X, \"raison\": \"explication courte\"}\n"
    },
    {
      "scenario_id": "S9_retour_phase1_depuis_phase2",
      "description": "Client change de produit en phase 2",
      "status": "ERROR",
      "error": "JSON parse error: Expecting value: line 1 column 1 (char 0)",
      "raw_response": "Analyse de l'état actuel :\n\n- Produit : \"Couches à pression\" (OK)\n- Variante : \"Taille 3 - Lot 300\" (OK)\n- Zone : \"Angré\" (OK)\n- Téléphone : ❌ manquant (manquant)\n- Paiement : ❌ manquant (manquant)\n\nEn fonction de la logique de décision, on se situe dans la situation suivante :\n\n- Produit et variante sont collectés, donc on ne rentre pas dans la Phase 1.\n- Zone est collectée, mais téléphone est manquant, donc on rentre dans la Phase 2.\n\nLa décision est donc :\n\n{\"phase\": 2",
      "prompt": "Tu es un routeur de workflow commercial. Analyse l'état de la collecte de données et détermine la phase suivante.\n\n## DONNÉES À COLLECTER (dans l'ordre)\n\n1. **PRODUIT + VARIANTE** (obligatoires ensemble)\n2. **ZONE + CONTACT** (obligatoires ensemble)  \n3. **PAIEMENT** (validation finale)\n\n## ÉTAT ACTUEL\n\n📦 Produit: Couches à pression\n🔧 Variante: Taille 3 - Lot 300\n📍 Zone: Angré\n📞 Téléphone: ❌ manquant\n💳 Paiement: ❌ manquant\n\n## HISTORIQUE CONVERSATION\n\nAgent: Quel est votre numéro?\nClient: Attendez, je veux plutôt des couches culottes\n\n## DONNÉES COLLECTÉES\n\n- produit: Couches à pression\n- variante: Taille 3 - Lot 300\n- zone: Angré\n- telephone: ❌ manquant\n- paiement: ❌ manquant\n\n## LOGIQUE DE DÉCISION (STRICTE)\n\n**PHASE 1 - Collecte Produit/Variante**\n→ SI produit = ❌ manquant OU variante = ❌ manquant\n→ ALORS Phase 1\n\n**PHASE 2 - Collecte Livraison/Contact**\n→ SI produit ≠ ❌ manquant ET variante ≠ ❌ manquant\n→ ET (zone = ❌ manquant OU telephone = ❌ manquant)\n→ ALORS Phase 2\n\n**PHASE 3 - Validation Paiement**\n→ SI produit ≠ ❌ manquant ET variante ≠ ❌ manquant\n→ ET zone ≠ ❌ manquant ET telephone ≠ ❌ manquant\n→ ALORS Phase 3\n\n## EXEMPLES\n\n**Exemple 1:**\n- Produit: ❌ manquant, Variante: ❌ manquant\n- Décision: Phase 1 (produit et variante manquants)\n\n**Exemple 2:**\n- Produit: \"Chaussures Nike\", Variante: \"Taille 42\"\n- Zone: ❌ manquant, Téléphone: ❌ manquant\n- Décision: Phase 2 (produit/variante OK, collecte livraison)\n\n**Exemple 3:**\n- Produit: \"Chaussures Nike\", Variante: \"Taille 42\"\n- Zone: \"Paris\", Téléphone: \"0601020304\"\n- Paiement: \"pending\"\n- Décision: Phase 3 (tout collecté, attente paiement)\n\n---\n\nQuestion client: Attendez, je veux plutôt des couches culottes\n\nAnalyse l'ÉTAT ACTUEL ci-dessus et retourne UNIQUEMENT:\n{\"phase\": X, \"raison\": \"explication courte\"}\n"
    },
    {
      "scenario_id": "S10_question_hors_sujet_phase1",
      "description": "Question générale en phase 1",
      "status": "PASS",
      "expected_phase": 1,
      "actual_phase": 1,
      "expected_raison": "produit et variante toujours manquants",
      "actual_raison": "Produit et variante manquants",
      "tokens_used": 653,
      "prompt": "Tu es un routeur de workflow commercial. Analyse l'état de la collecte de données et détermine la phase suivante.\n\n## DONNÉES À COLLECTER (dans l'ordre)\n\n1. **PRODUIT + VARIANTE** (obligatoires ensemble)\n2. **ZONE + CONTACT** (obligatoires ensemble)  \n3. **PAIEMENT** (validation finale)\n\n## ÉTAT ACTUEL\n\n📦 Produit: ❌ manquant\n🔧 Variante: ❌ manquant\n📍 Zone: ❌ manquant\n📞 Téléphone: ❌ manquant\n💳 Paiement: ❌ manquant\n\n## HISTORIQUE CONVERSATION\n\nClient: Vous livrez partout à Abidjan?\n\n## DONNÉES COLLECTÉES\n\n- produit: ❌ manquant\n- variante: ❌ manquant\n- zone: ❌ manquant\n- telephone: ❌ manquant\n- paiement: ❌ manquant\n\n## LOGIQUE DE DÉCISION (STRICTE)\n\n**PHASE 1 - Collecte Produit/Variante**\n→ SI produit = ❌ manquant OU variante = ❌ manquant\n→ ALORS Phase 1\n\n**PHASE 2 - Collecte Livraison/Contact**\n→ SI produit ≠ ❌ manquant ET variante ≠ ❌ manquant\n→ ET (zone = ❌ manquant OU telephone = ❌ manquant)\n→ ALORS Phase 2\n\n**PHASE 3 - Validation Paiement**\n→ SI produit ≠ ❌ manquant ET variante ≠ ❌ manquant\n→ ET zone ≠ ❌ manquant ET telephone ≠ ❌ manquant\n→ ALORS Phase 3\n\n## EXEMPLES\n\n**Exemple 1:**\n- Produit: ❌ manquant, Variante: ❌ manquant\n- Décision: Phase 1 (produit et variante manquants)\n\n**Exemple 2:**\n- Produit: \"Chaussures Nike\", Variante: \"Taille 42\"\n- Zone: ❌ manquant, Téléphone: ❌ manquant\n- Décision: Phase 2 (produit/variante OK, collecte livraison)\n\n**Exemple 3:**\n- Produit: \"Chaussures Nike\", Variante: \"Taille 42\"\n- Zone: \"Paris\", Téléphone: \"0601020304\"\n- Paiement: \"pending\"\n- Décision: Phase 3 (tout collecté, attente paiement)\n\n---\n\nQuestion client: Vous livrez partout à Abidjan?\n\nAnalyse l'ÉTAT ACTUEL ci-dessus et retourne UNIQUEMENT:\n{\"phase\": X, \"raison\": \"explication courte\"}\n",
      "raw_response": "{\"phase\": 1, \"raison\": \"Produit et variante manquants\"}"
    },
    {
      "scenario_id": "S11_multi_produits",
      "description": "Client veut plusieurs produits différents",
      "status": "PASS",
      "expected_phase": 2,
      "actual_phase": 2,
      "expected_raison": "produits/variantes OK, passage à livraison",
      "actual_raison": "Produit et variante collectés, mais zone et téléphone manquants",
      "tokens_used": 738,
      "prompt": "Tu es un routeur de workflow commercial. Analyse l'état de la collecte de données et détermine la phase suivante.\n\n## DONNÉES À COLLECTER (dans l'ordre)\n\n1. **PRODUIT + VARIANTE** (obligatoires ensemble)\n2. **ZONE + CONTACT** (obligatoires ensemble)  \n3. **PAIEMENT** (validation finale)\n\n## ÉTAT ACTUEL\n\n📦 Produit: Couches à pression T1 + Couches culottes T4\n🔧 Variante: Lot 300 + Lot 150\n📍 Zone: ❌ manquant\n📞 Téléphone: ❌ manquant\n💳 Paiement: ❌ manquant\n\n## HISTORIQUE CONVERSATION\n\nClient: Je veux des couches à pression T1 et des culottes T4\nAgent: Parfait! Quelle quantité pour chaque?\nClient: Un lot de 300 pour les T1 et un lot de 150 pour les T4\n\n## DONNÉES COLLECTÉES\n\n- produit: Couches à pression T1 + Couches culottes T4\n- variante: Lot 300 + Lot 150\n- zone: ❌ manquant\n- telephone: ❌ manquant\n- paiement: ❌ manquant\n\n## LOGIQUE DE DÉCISION (STRICTE)\n\n**PHASE 1 - Collecte Produit/Variante**\n→ SI produit = ❌ manquant OU variante = ❌ manquant\n→ ALORS Phase 1\n\n**PHASE 2 - Collecte Livraison/Contact**\n→ SI produit ≠ ❌ manquant ET variante ≠ ❌ manquant\n→ ET (zone = ❌ manquant OU telephone = ❌ manquant)\n→ ALORS Phase 2\n\n**PHASE 3 - Validation Paiement**\n→ SI produit ≠ ❌ manquant ET variante ≠ ❌ manquant\n→ ET zone ≠ ❌ manquant ET telephone ≠ ❌ manquant\n→ ALORS Phase 3\n\n## EXEMPLES\n\n**Exemple 1:**\n- Produit: ❌ manquant, Variante: ❌ manquant\n- Décision: Phase 1 (produit et variante manquants)\n\n**Exemple 2:**\n- Produit: \"Chaussures Nike\", Variante: \"Taille 42\"\n- Zone: ❌ manquant, Téléphone: ❌ manquant\n- Décision: Phase 2 (produit/variante OK, collecte livraison)\n\n**Exemple 3:**\n- Produit: \"Chaussures Nike\", Variante: \"Taille 42\"\n- Zone: \"Paris\", Téléphone: \"0601020304\"\n- Paiement: \"pending\"\n- Décision: Phase 3 (tout collecté, attente paiement)\n\n---\n\nQuestion client: Un lot de 300 pour les T1 et un lot de 150 pour les T4\n\nAnalyse l'ÉTAT ACTUEL ci-dessus et retourne UNIQUEMENT:\n{\"phase\": X, \"raison\": \"explication courte\"}\n",
      "raw_response": "{\"phase\": 2, \"raison\": \"Produit et variante collectés, mais zone et téléphone manquants\"}"
    },
    {
      "scenario_id": "S12_clarification_produit",
      "description": "Client demande plus d'infos sur produit",
      "status": "ERROR",
      "error": "JSON parse error: Expecting value: line 1 column 1 (char 0)",
      "raw_response": "Analyse de l'état actuel :\n\n- Le client a posé une question sur la différence entre couches à pression et culottes.\n- Les données collectées sont :\n  - produit: ❌ manquant\n  - variante: ❌ manquant\n  - zone: ❌ manquant\n  - telephone: ❌ manquant\n  - paiement: ❌ manquant\n\nEn fonction de la logique de décision, nous sommes dans la situation suivante :\n\n- Le client a posé une question, ce qui n'est pas une action de collecte de données.\n- Les données collectées sont manquantes pour le produit, la variante, la zone et le téléphone.\n- Le",
      "prompt": "Tu es un routeur de workflow commercial. Analyse l'état de la collecte de données et détermine la phase suivante.\n\n## DONNÉES À COLLECTER (dans l'ordre)\n\n1. **PRODUIT + VARIANTE** (obligatoires ensemble)\n2. **ZONE + CONTACT** (obligatoires ensemble)  \n3. **PAIEMENT** (validation finale)\n\n## ÉTAT ACTUEL\n\n📦 Produit: ❌ manquant\n🔧 Variante: ❌ manquant\n📍 Zone: ❌ manquant\n📞 Téléphone: ❌ manquant\n💳 Paiement: ❌ manquant\n\n## HISTORIQUE CONVERSATION\n\nClient: C'est quoi la différence entre couches à pression et culottes?\n\n## DONNÉES COLLECTÉES\n\n- produit: ❌ manquant\n- variante: ❌ manquant\n- zone: ❌ manquant\n- telephone: ❌ manquant\n- paiement: ❌ manquant\n\n## LOGIQUE DE DÉCISION (STRICTE)\n\n**PHASE 1 - Collecte Produit/Variante**\n→ SI produit = ❌ manquant OU variante = ❌ manquant\n→ ALORS Phase 1\n\n**PHASE 2 - Collecte Livraison/Contact**\n→ SI produit ≠ ❌ manquant ET variante ≠ ❌ manquant\n→ ET (zone = ❌ manquant OU telephone = ❌ manquant)\n→ ALORS Phase 2\n\n**PHASE 3 - Validation Paiement**\n→ SI produit ≠ ❌ manquant ET variante ≠ ❌ manquant\n→ ET zone ≠ ❌ manquant ET telephone ≠ ❌ manquant\n→ ALORS Phase 3\n\n## EXEMPLES\n\n**Exemple 1:**\n- Produit: ❌ manquant, Variante: ❌ manquant\n- Décision: Phase 1 (produit et variante manquants)\n\n**Exemple 2:**\n- Produit: \"Chaussures Nike\", Variante: \"Taille 42\"\n- Zone: ❌ manquant, Téléphone: ❌ manquant\n- Décision: Phase 2 (produit/variante OK, collecte livraison)\n\n**Exemple 3:**\n- Produit: \"Chaussures Nike\", Variante: \"Taille 42\"\n- Zone: \"Paris\", Téléphone: \"0601020304\"\n- Paiement: \"pending\"\n- Décision: Phase 3 (tout collecté, attente paiement)\n\n---\n\nQuestion client: C'est quoi la différence entre couches à pression et culottes?\n\nAnalyse l'ÉTAT ACTUEL ci-dessus et retourne UNIQUEMENT:\n{\"phase\": X, \"raison\": \"explication courte\"}\n"
    }
  ]
}